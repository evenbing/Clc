@using Clc.Fields.Entities
@{
    Layout = "~/Views/Shared/_CrudLayout.cshtml";
}

@section customScript
{
    <script type="text/javascript">
        crud.dgDefault.name = 'Depots';
        crud.dgDefault.sortName = 'cn';
        // crud.dgDefault.title = abp.setting.get('VI.DepotTitleName');
        crud.dgDefault.columns = [[
            { field: "cn", title: "编号", width: 100 },
            { field: "name", title: "名称", width: 100 },
            { field: "radius", title: "签到半径(米)", width: 100 },
            { field: "longitude", title: "经度", width: 120 },
            { field: "latitude", title: "纬度", width: 120 },
            { field: "activeRouteNeedCheckin", title: "激活线路先签到", width: 100 },
            { field: "relyDepotId", title: "依赖于", width: 80, formatter: relyDepotFormatter }
        ]];

        // formatters
        function relyDepotFormatter (val) {
            return crud.getComboTextByInt('#relyDepot', val);
        }
    </script>
}

@section endScript
{
    <script type="text/javascript">
        crud.startfunction = function () {
            abp.services.app.field.getComboItems('Depot').done(function(d) {
                crud.setComboBox('#relyDepot', d);
            });
        };
    </script>
}

@*弹窗*@
<div id="dlg" class="easyui-dialog" closed="true" modal="true" buttons="#dlg-buttons" align="center" style="width: 450px; padding: 10px;">
    <form id="fm" class="easyui-form" method="post" novalidate>
        <table class="edit-tbl">
            <input id="id" name="id" type="hidden">
            <tr>
                <th><label for="cn">编号：</label></th>
                <td><input name="cn" class="easyui-textbox" data-options="required:true, validType:'length[@Depot.MaxCnLength, @Depot.MaxCnLength]'" style="width: 100%"></td>
            </tr>
                <th><label for="name">名称：</label></th>
                <td><input name="name" class="easyui-textbox" data-options="required:true, validType:'length[2, @Depot.MaxNameLength]'" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="longitude">经度：</label></th>
                <td><input name="longitude" class="easyui-numberbox" data-options="precision:6" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="latitude">纬度：</label></th>
                <td><input name="latitude" class="easyui-numberbox" data-options="precision:6" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="radius">签到半径(米)：</label></th>
                <td><input name="radius" class="easyui-numberbox" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="activeRouteNeedCheckin">激活线路先签到: </label></th>
                <td><input name="activeRouteNeedCheckin" class="easyui-switchbutton" data-options="height:24,onText:'是',offText:'否'">
                </td>
            </tr>
            <tr>
                <th><label for="relyDepotId">依赖于：</label></th>
                <td><input id="relyDepot" name="relyDepotId" class="easyui-combobox" style="width: 100%"></td>
            </tr>
        </table>
    </form>
</div>
