@{
    Layout = "~/Views/Shared/_CrudLayout.cshtml";
}

@section customScript
{
    <script type="text/javascript">
        crud.dgDefault.name = 'WorkRoles';
        crud.dgDefault.sortName = 'cn';
        crud.dgDefault.columns = [[
            { field: "cn", title: "编号", width: 80, sortable: true },
            { field: "name", title: "名称", width: 80, sortable: true },
            { field: "defaultWorkerTypeId", title: "缺省人员类型", width: 80, sortable: true, formatter: workerTypeFormatter  },
            { field: "category", title: "类别", width: 80, sortable: true},
            { field: "duties", title: "职责", width: 80, sortable: false },
        ]];

        function workerTypeFormatter (val) {
            return crud.getComboTextByInt('#workerType', val);
        }
    </script>
}

@section endScript
{
    <script type="text/javascript">
        crud.startfunction = function () {
            abp.services.app.type.getComboItems('WorkerType').done(function(d) { crud.setComboBox('#workerType', d); });
            abp.services.app.type.getDutyCategories().done(function(d) { crud.setComboBox('#category', d); });
            $('#category').combobox({
                onSelect: function(rec) {
                    abp.services.app.type.getDuties(rec.value).done(function(d) { crud.setTagBox('#duties', d); });
                }
            });
        }     
    </script>
}

@*弹窗*@
<div id="dlg" class="easyui-dialog" closed="true" modal="true" align="center" style="width: 400px; padding: 10px;">
    <form id="fm" method="post" novalidate>
        <table class="edit-tbl">
            <input id="id" name="id" type="hidden">
            <tr>
                <th><label for="cn">编号：</label></th>
                <td><input name="cn" class="easyui-textbox" data-options="required:true, validType:'length[1, @Clc.Types.Entities.WorkerType.MaxCnLength]'" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="name">名称：</label></th>
                <td><input name="name" class="easyui-textbox" data-options="required:true, validType:'length[1, @Clc.Types.Entities.WorkerType.MaxNameLength]'" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="defaultWorkerTypeId">缺省人员类型：</label></th>
                <td><input id="workerType" name="defaultWorkerTypeId" class="easyui-combobox" data-options="required:true" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="category">职责类别：</label></th>
                <td><input id="category" name="category" class="easyui-combobox" data-options="required:true" style="width: 100%"></td>
            </tr>
            <tr>
                <th><label for="duties">职责列表：</label></th>
                <td><input id="duties" name="duties" class="easyui-tagbox" data-options="required:true" style="width: 100%"></td>
            </tr>
        </table>
    </form>
</div>
